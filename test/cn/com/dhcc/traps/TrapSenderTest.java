package cn.com.dhcc.traps;

import static org.junit.Assert.*;

import java.io.IOException;
import java.net.InetAddress;
import java.net.UnknownHostException;
import java.text.ParseException;
import java.util.Date;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.snmp4j.PDU;
import org.snmp4j.PDUv1;
import org.snmp4j.mp.SnmpConstants;
import org.snmp4j.smi.Integer32;
import org.snmp4j.smi.IpAddress;
import org.snmp4j.smi.OID;
import org.snmp4j.smi.OctetString;
import org.snmp4j.smi.TimeTicks;
import org.snmp4j.smi.VariableBinding;

import cn.com.dhcc.traps.TrapSender;

public class TrapSenderTest {

	@Before
	public void setUp() throws Exception {
	}

	@After
	public void tearDown() throws Exception {
	}

	@Test
	public void testSendPDUv1() throws IOException, ParseException {
		TrapSender sender = new TrapSender(SnmpConstants.version1);
        PDUv1 pdu = new PDUv1();
        pdu.setAgentAddress(new IpAddress(InetAddress.getLocalHost()));
        pdu.setEnterprise(new OID("1.3.6.1.4.1.6876.888.1.1"));
        pdu.setTimestamp(0);
        pdu.setType(PDU.V1TRAP);
        pdu.setGenericTrap(PDUv1.ENTERPRISE_SPECIFIC);
        pdu.setSpecificTrap(203);
        
        sender.sendPDU(pdu);
	}

	
	@Test
	public void testSendPDUv2() throws IOException, ParseException {
		
TrapSender sender = new TrapSender();
        PDU pdu = new PDU();
        pdu.setErrorIndex(0);
        pdu.setErrorStatus(0);
        pdu.setRequestID(new Integer32(0));
        //加入设备启动时间
        pdu.add(new VariableBinding(SnmpConstants.sysUpTime,new TimeTicks(1000)));
        
		//设定第二个变量snmpTrapOID
		pdu.add(new VariableBinding(SnmpConstants.snmpTrapOID, new OID(".1.2.156.112546.16.0.1")));
            pdu.add(new VariableBinding(new OID("1.3.6.1.4.1.6876.4.3.306.0"),  
                new OctetString("0x61 0x6C 0x61 0x72 0x6D 0x2E 0x48 0x6F 0x73 0x74 0x43 0x6F 0x6E 0x6E 0x65 0x63 0x74 0x69 0x76 0x69 0x74 0x79 0x41 0x6C 0x61 0x72 0x6D 0x20 0x2D 0x20 0xE4 0xBA 0x8B 0xE4 0xBB 0xB6 0x3A 0x20 0xE4 0xB8 0xBB 0xE6 0x9C 0xBA 0xE8 0xBF 0x9E 0xE6 0x8E 0xA5 0xE4 0xB8 0xA2 0xE5 0xA4 0xB1 0x20 0x28 0x38 0x38 0x30 0x39 0x37 0x39 0x36 0x29 0x0A 0xE6 0x91 0x98 0xE8 0xA6 0x81 0x3A 0x20 0x43 0x6C 0x6F 0x75 0x64 0x2D 0x44 0x61 0x74 0x61 0x43 0x65 0x6E 0x74 0x65 0x72 0x20 0xE4 0xB8 0xAD 0xE7 0x9A 0x84 0xE4 0xB8 0xBB 0xE6 0x9C 0xBA 0x20 0x31 0x39 0x32 0x2E 0x31 0x36 0x38 0x2E 0x31 0x30 0x30 0x2E 0x38 0x35 0x20 0xE6 0x97 0xA0 0xE5 0x93 0x8D 0xE5 0xBA 0x94 0x0A 0xE6 0x97 0xA5 0xE6 0x9C 0x9F 0x3A 0x20 0x32 0x30 0x31 0x34 0x2F 0x38 0x2F 0x35 0x20 0x32 0x3A 0x33 0x35 0x3A 0x33 0x38 0x0A 0xE4 0xB8 0xBB 0xE6 0x9C 0xBA 0x3A 0x20 0x31 0x39 0x32 0x2E 0x31 0x36 0x38 0x2E 0x31 0x30 0x30 0x2E 0x38 0x35 0x0A 0xE8 0xB5 0x84 0xE6 0xBA 0x90 0xE6 0xB1 0xA0 0x3A 0x20 0x43 0x6C 0x6F 0x75 0x64 0x2D 0x48 0x44 0x0A 0xE6 0x95 0xB0 0xE6 0x8D 0xAE 0xE4 0xB8 0xAD 0xE5 0xBF 0x83 0x3A 0x20 0x43 0x6C 0x6F 0x75 0x64 0x2D 0x44 0x61 0x74 0x61 0x43 0x65 0x6E 0x74 0x65 0x72 0x0A")));  
            pdu.add(new VariableBinding(new OID("1.3.6.1.4.1.6876.4.3.305"),  
                    new OctetString("0x61 0x6C 0x61 0x72 0x6D 0x2E 0x48 0x6F 0x73 0x74 0x43 0x6F 0x6E 0x6E 0x65 0x63 0x74 0x69 0x76 0x69 0x74 0x79 0x41 0x6C 0x61 0x72 0x6D 0x20 0x2D 0x20 0xE4 0xBA 0x8B 0xE4 0xBB 0xB6 0x3A 0x20 0xE4 0xB8 0xBB 0xE6 0x9C 0xBA 0xE8 0xBF 0x9E 0xE6 0x8E 0xA5 0xE4 0xB8 0xA2 0xE5 0xA4 0xB1 0x20 0x28 0x38 0x38 0x30 0x39 0x37 0x39 0x36 0x29 0x0A 0xE6 0x91 0x98 0xE8 0xA6 0x81 0x3A 0x20 0x43 0x6C 0x6F 0x75 0x64 0x2D 0x44 0x61 0x74 0x61 0x43 0x65 0x6E 0x74 0x65 0x72 0x20 0xE4 0xB8 0xAD 0xE7 0x9A 0x84 0xE4 0xB8 0xBB 0xE6 0x9C 0xBA 0x20 0x31 0x39 0x32 0x2E 0x31 0x36 0x38 0x2E 0x31 0x30 0x30 0x2E 0x38 0x35 0x20 0xE6 0x97 0xA0 0xE5 0x93 0x8D 0xE5 0xBA 0x94 0x0A 0xE6 0x97 0xA5 0xE6 0x9C 0x9F 0x3A 0x20 0x32 0x30 0x31 0x34 0x2F 0x38 0x2F 0x35 0x20 0x32 0x3A 0x33 0x35 0x3A 0x33 0x38 0x0A 0xE4 0xB8 0xBB 0xE6 0x9C 0xBA 0x3A 0x20 0x31 0x39 0x32 0x2E 0x31 0x36 0x38 0x2E 0x31 0x30 0x30 0x2E 0x38 0x35 0x0A 0xE8 0xB5 0x84 0xE6 0xBA 0x90 0xE6 0xB1 0xA0 0x3A 0x20 0x43 0x6C 0x6F 0x75 0x64 0x2D 0x48 0x44 0x0A 0xE6 0x95 0xB0 0xE6 0x8D 0xAE 0xE4 0xB8 0xAD 0xE5 0xBF 0x83 0x3A 0x20 0x43 0x6C 0x6F 0x75 0x64 0x2D 0x44 0x61 0x74 0x61 0x43 0x65 0x6E 0x74 0x65 0x72 0x0A")));  
        
    			pdu.add(new VariableBinding(new OID( SnmpConstants.snmpTrapEnterprise.toDottedString()),  
                        new OID(".1.3.6.1.4.1.6876.12")));  
        pdu.setType(PDU.TRAP);  
 	}
	
	
	@Test
	public void testPreInit(){
		Class clazz = TrapSender.class;
		System.out.println(TrapSender.getIP()+":"+TrapSender.getPORT());
	}
}
